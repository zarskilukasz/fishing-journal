---
/**
 * Catch details page.
 * Displays full information about a specific catch.
 *
 * Route: /app/catches/[id]
 * Access: Requires authentication (owner of the catch via trip ownership)
 */
import AppLayout from "@/layouts/AppLayout.astro";
import { CatchDetailView } from "@/components/catch-detail";

// Get Supabase client from middleware (auth already verified in AppLayout)
const supabase = Astro.locals.supabase;
const {
  data: { user },
  error,
} = await supabase.auth.getUser();

// Redirect if not authenticated (should not happen due to AppLayout check)
if (error || !user) {
  return Astro.redirect("/");
}

const { id } = Astro.params;

// Validate that id is present
if (!id) {
  return Astro.redirect("/app");
}
---

<AppLayout title="Szczegóły połowu" showBackButton>
  <CatchDetailView client:load catchId={id} />
</AppLayout>

